var knapsack = require('knapsack-js');

export default async function handler(req, res) {


  var items = [
    {'27454140': 130000.7},
    {'27453915': 76400.6},
    {'27453584': 60000.2},
    {'27453139': 460001.7},
    {'27452790': 340000.3},
    {'27452425': 284002},
    {'27452108': 150000.3},
    {'27451373': 339512.4},
    {'27451225': 95005.2},
    {'27451068': 249905.2},
    {'27450294': 349704.8},
    {'27449005': 269505.2},
    {'27448977': 159801.3},
    {'27448828': 69900.3},
    {'27447511': 249900.4},
    {'27447276': 249905.2},
    {'27446878': 170005.2},
    {'27446851': 170005.2},
    {'27446810': 6948005.2},
    {'27446708': 6948005.2},
    {'27445779': 160005.2},
    {'27445427': 150005.3},
    {'27445229': 249905.2},
    {'27444186': 570007.4},
    {'27444160': 170005.2},
    {'27444072': 6948005.2},
    {'27443921': 6948005.2},
    {'27443862': 60000.2},
    {'27442769': 170000.6},
    {'27442084': 6948005.2},
    {'27441015': 100002.3},
    {'27439477': 60000.1},
    {'27438973': 60000.1},
    {'27438966': 240002.9},
    {'27438473': 120000.7},
    {'27437333': 120000.1},
    {'27435729': 999600.6},
    {'27434949': 110001.1},
    {'27433760': 50000.2},
    {'27433564': 170001.8},
    {'27430089': 120000.3},
    {'27365525': 153401.1},
  ];
  let selected = knapsack.resolve(2590065, items);
  let keys = selected.map((a,b) => (
      Object.keys(a)[0]
  ));
  let keysSelectJs = selected.map((a,b) => (
      'then(() => {document.querySelector("tr[id=\''+Object.keys(a)[0]+'\'] input[type=checkbox]").click(); })'
  ));
/*

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

 */

  //res.status(200).json(keys.join(","));
  res.status(200).json("sleep(10)." + keysSelectJs.join(".then(() => sleep(5000))."));
}
